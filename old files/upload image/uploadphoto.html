
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Language" content="en-us" />
	<title>Upload a new profile picture</title>
	
	<link rel="stylesheet" href="prof.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/prototype/1.7.0.0/prototype.js" type="text/javascript"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/scriptaculous/1.9.0/scriptaculous.js" type="text/javascript"></script>
	<script src="cropper.js" type="text/javascript"></script>

	<script type="text/javascript" charset="utf-8">
		// setup the callback function
		function onEndCrop( coords, dimensions ) {
			$( 'x1' ).value = coords.x1;
			$( 'y1' ).value = coords.y1;
			$( 'x2' ).value = coords.x2;
			$( 'y2' ).value = coords.y2;
			$( 'width' ).value = dimensions.width;
			$( 'height' ).value = dimensions.height;
		}
		
		// basic example
		Event.observe( 
			window, 
			'load', 
			function() { 
				new Cropper.Img( 
					'testImage',
					{
						onEndCrop: onEndCrop 
					}
				);
			}
		);
		
		
	</script>

<script> 
(function($) { 
$(document).ready(function() { 
    var readURL = function(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('.profile-pic').attr('src', e.target.result);
            }
    
            reader.readAsDataURL(input.files[0]);
        }
    }
  
    $(".file-upload").on('change', function(){
        readURL(this);
    });
    

});
})(jQuery);
</script>

<script>
function encodeImageFileAsURL(){

    var filesSelected = document.getElementById("profilePhoto").files;
    if (filesSelected.length > 0)
    {
        var fileToLoad = filesSelected[0];

        var fileReader = new FileReader();

        fileReader.onload = function(fileLoadedEvent) {
            var srcData = fileLoadedEvent.target.result; // <--- data: base64
			
		//	document.getElementById("imgUpload").innerHTML = srcData;
			
			//console.log(document.getElementById("imgUpload").innerHTML);
			//console.log(srcData);
			
			//var newImage = document.createElement('img');
			//newImage.src = srcData;

			//document.getElementById("imgUpload").innerHTML = newImage.outerHTML;
			//console.log("Converted Base64 version is "+document.getElementById("imgUpload").innerHTML);
        }
        fileReader.readAsDataURL(fileToLoad);
    }
	
//	var div = document.getElementById("imgUpload");
	// hide
//	div.style.visibility = 'hidden';
}
</script>

	<style type="text/css">
		label { 
			clear: left;
			margin-left: 50px;
			float: left;
			width: 5em;
		}
		
		html, body { 
			margin: 0;
		}
		
		#testWrap {
			margin: 20px 0 0 50px; /* Just while testing, to make sure we return the correct positions for the image & not the window */
		}
	
	img {
    position: absolute;
	
   
}
	
	</style>
	
</head>
<body>
	<h2>Upload a new profile picture</h2>
	
	<div id="testWrap">
		<img src="" height="300" width="300"= alt="test image" id="testImage" class="profile-pic" />
		
		<div class="text-center">
			
		<input id="profilePhoto" class="file-upload" type="file" onchange="encodeImageFileAsURL();" accept="image/*"/> 
		<div id="imgUpload" visibility="hidden"></div>
		
		</div>
		
	</div>
	
	
	<p>
		<label for="x1">x1:</label>
		<input type="text" name="x1" id="x1" />
	</p>
	<p>
		<label for="y1">y1:</label>
		<input type="text" name="y1" id="y1" />
	</p>
	<p>
		<label for="x2">x2:</label>
		<input type="text" name="x2" id="x2" />
	</p>
	<p>
		<label for="y2">y2:</label>
		<input type="text" name="y2" id="y2" />
	</p>
	<p>
		<label for="width">width:</label>
		<input type="text" name="width" id="width" />
	</p>
	<p>
		<label for="height">height</label>
		<input type="text" name="height" id="height" />
	</p>  
	<button onclick="clipImage()">crop</button>
	<button onclick="showProf()">Cancel</button>
	<img src=""  id="myImg" height="300" width="300" style="display:none" class="profile-pic" />
	
	<canvas id="myCanvas" width="100" height="100" style="border:1px solid #d3d3d3;">
	
	
	<style>

	</style>
	
	<script>
	
	
	/*function trial1(){
		document.getElementById("testImage1").setAttribute("position", "absolute"); 
		document.getElementById("testImage1").setAttribute("clip", "rect(0px,60px,200px,0px)"); 
		document.getElementById("testImage1").style.clip = "rect(0px 75px 75px 0px)";
		//document.getElementById("testImage1").style.position = "absolute";
		//document.getElementById("testImage1").style.clip = "rect(0px,60px,200px,0px)";
		}*/
		function clipImage() {
		var x1=document.getElementById("x1").value;
	 var y1=document.getElementById("y1").value;
	 var x2=document.getElementById("x2").value;
	 var y2=document.getElementById("y2").value;
  //  document.getElementById("myImg").style.clip = "rect("+y1+"px "+x2+"px "+y2+"px "+x1+"px)";
	//document.getElementById("myImg").style.backgroundImage="none";
	//document.getElementById("myImg").style.height="400px";
	//document.getElementById("myImg").style.width="400px";
	
	var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    var img = document.getElementById("myImg");
    ctx.drawImage(img,x1,y1,100,100,0,0,100,100);
}
function showProf() {
    window.location.href="prof.html";	
}
	</script>
</body>
</html>


